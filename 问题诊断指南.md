# ğŸ” é—®é¢˜è¯Šæ–­æŒ‡å—

> å¦‚æœæ¸…é™¤æ•°æ®åè¿˜æ˜¯çœ‹ä¸åˆ°ä¸¤çº§åˆ†ç»„åŠŸèƒ½ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤è¯Šæ–­

---

## ğŸ“‹ è¯Šæ–­æ­¥éª¤

### æ­¥éª¤ 1ï¼šä½¿ç”¨æµ‹è¯•å·¥å…·

1. **è®¿é—®æµ‹è¯•é¡µé¢**ï¼š
   ```
   http://localhost:8000/02-tools/test-grouping.html
   ```

2. **ä¾æ¬¡ç‚¹å‡»æ‰€æœ‰æŒ‰é’®**ï¼ŒæŸ¥çœ‹ç»“æœï¼š
   - "æ£€æŸ¥æ•°æ®" - æŸ¥çœ‹ LocalStorage ä¸­çš„æ•°æ®
   - "æ£€æŸ¥ Demo æ•°æ®" - æŸ¥çœ‹ demo_data.js ä¸­çš„æ•°æ®
   - "æ¸…é™¤ Papers" - æ¸…é™¤æ•°æ®
   - "æµ‹è¯•åˆ†ç»„é€»è¾‘" - æµ‹è¯•åˆ†ç»„åŠŸèƒ½

3. **è®°å½•æ‰€æœ‰é”™è¯¯ä¿¡æ¯**

---

### æ­¥éª¤ 2ï¼šæ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

1. **æ‰“å¼€ä¸»åº”ç”¨**ï¼š`http://localhost:8000`
2. **æŒ‰ F12** æ‰“å¼€å¼€å‘è€…å·¥å…·
3. **ç‚¹å‡» "Console" æ ‡ç­¾**
4. **è¿›å…¥ Risk Report é¡µé¢**
5. **æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º**ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ“ Auto-loading demo data...
æˆ–
ğŸ”„ Updating existing paper with new fields...

ğŸ“Š Grouping risk: { id: '...', level1: 'Data Risk', level2: 'Data Governance', ... }
ğŸ“Š Grouped structure: { 'Data Risk': { 'Data Governance': [...] } }

ğŸ§­ QuickNav grouping: { id: '...', level1: 'Data Risk', level2: 'Data Governance', ... }
ğŸ§­ QuickNav grouped structure: { 'Data Risk': { 'Data Governance': [...] } }
```

---

### æ­¥éª¤ 3ï¼šæ‰‹åŠ¨æ£€æŸ¥æ•°æ®

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¾“å…¥ï¼š

```javascript
// 1. æ£€æŸ¥ LocalStorage
const papers = JSON.parse(localStorage.getItem('riskgen_papers') || '[]')
console.log('Papers:', papers)

// 2. æ£€æŸ¥ç¬¬ä¸€ä¸ª paper çš„æ•°æ®
if (papers.length > 0) {
    const paper = papers[0]
    console.log('First paper:', paper)
    console.log('Results:', paper.results)
    
    // 3. æ£€æŸ¥æ¯ä¸ª risk æ˜¯å¦æœ‰æ–°å­—æ®µ
    paper.results?.forEach((r, i) => {
        console.log(`Risk ${i}:`, {
            id: r.id,
            level1_risk_type: r.level1_risk_type,
            level2_3_risk_category: r.level2_3_risk_category,
            has_both: !!(r.level1_risk_type && r.level2_3_risk_category)
        })
    })
}

// 4. æ£€æŸ¥ Demo æ•°æ®
if (typeof BACKEND_DATA_JSON !== 'undefined') {
    console.log('Demo data:', BACKEND_DATA_JSON)
    BACKEND_DATA_JSON.forEach((d, i) => {
        console.log(`Demo ${i}:`, {
            level1_risk_type: d.level1_risk_type,
            level2_3_risk_category: d.level2_3_risk_category
        })
    })
} else {
    console.error('âŒ BACKEND_DATA_JSON æœªå®šä¹‰ï¼')
}
```

---

### æ­¥éª¤ 4ï¼šæ£€æŸ¥é¡µé¢å…ƒç´ 

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¾“å…¥ï¼š

```javascript
// æ£€æŸ¥æ˜¯å¦æœ‰åˆ†ç»„å…ƒç´ 
const level1Groups = document.querySelectorAll('.risk-level1-group')
const level2Groups = document.querySelectorAll('.risk-level2-group')
const navLevel1 = document.querySelectorAll('.nav-level1-group')
const navLevel2 = document.querySelectorAll('.nav-level2-group')

console.log('Risk Report Level 1 groups:', level1Groups.length)
console.log('Risk Report Level 2 groups:', level2Groups.length)
console.log('QuickNav Level 1 groups:', navLevel1.length)
console.log('QuickNav Level 2 groups:', navLevel2.length)

// å¦‚æœæ•°é‡ä¸º 0ï¼Œè¯´æ˜åˆ†ç»„æ²¡æœ‰æ¸²æŸ“
if (level1Groups.length === 0) {
    console.error('âŒ æ²¡æœ‰æ‰¾åˆ° Level 1 åˆ†ç»„å…ƒç´ ï¼')
}

// æ£€æŸ¥å®é™…æ¸²æŸ“çš„ HTML
const container = document.getElementById('risk-report-container')
if (container) {
    console.log('Container HTML:', container.innerHTML.substring(0, 500))
}
```

---

### æ­¥éª¤ 5ï¼šå¼ºåˆ¶é‡æ–°åˆ›å»ºæ•°æ®

å¦‚æœæ•°æ®æœ‰é—®é¢˜ï¼Œå¼ºåˆ¶æ¸…é™¤å¹¶é‡æ–°åˆ›å»ºï¼š

```javascript
// 1. æ¸…é™¤æ‰€æœ‰ papers
localStorage.removeItem('riskgen_papers')

// 2. ç¡®ä¿ demo_data.js å·²åŠ è½½
if (typeof BACKEND_DATA_JSON === 'undefined') {
    console.error('âŒ BACKEND_DATA_JSON æœªå®šä¹‰ï¼Œè¯·æ£€æŸ¥ js/demo_data.js æ˜¯å¦æ­£ç¡®åŠ è½½')
} else {
    console.log('âœ… Demo æ•°æ®å·²åŠ è½½:', BACKEND_DATA_JSON.length, 'ä¸ªé£é™©')
    
    // 3. æ‰‹åŠ¨åˆ›å»º paperï¼ˆæ¨¡æ‹Ÿ createDemoPaperï¼‰
    const projectId = JSON.parse(localStorage.getItem('riskgen_projects') || '[]')[0]?.id
    if (projectId) {
        const demoPaper = {
            id: 'paper_demo_' + Date.now(),
            name: 'Demo Risk Assessment - GenAI Chatbot',
            createdAt: new Date().toISOString(),
            projectId: projectId,
            status: 'completed',
            results: BACKEND_DATA_JSON.map((d, i) => ({
                id: `demo_risk_${i}`,
                category: {
                    level1: 'Data Risk',
                    level2: 'Data Governance',
                    level3: d.risk_details?.risk_title || 'Imported Risk'
                },
                is_applicable: d.is_applicable === "true" || d.is_applicable === true,
                level1_risk_type: d.level1_risk_type || 'Other',
                level2_3_risk_category: d.level2_3_risk_category || 'Uncategorized',
                status: 'draft',
                risk_details: d.risk_details
            })),
            capturedData: {}
        }
        
        localStorage.setItem('riskgen_papers', JSON.stringify([demoPaper]))
        console.log('âœ… Paper å·²åˆ›å»ºï¼Œè¯·åˆ·æ–°é¡µé¢')
        location.reload()
    }
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šæ§åˆ¶å°æ˜¾ç¤º "BACKEND_DATA_JSON æœªå®šä¹‰"

**åŸå› **ï¼š`js/demo_data.js` æ²¡æœ‰æ­£ç¡®åŠ è½½

**è§£å†³**ï¼š
1. æ£€æŸ¥ `index.html` ä¸­æ˜¯å¦æœ‰ `<script src="js/demo_data.js"></script>`
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰åŠ è½½é”™è¯¯

### é—®é¢˜ 2ï¼šæ•°æ®æœ‰ï¼Œä½†é¡µé¢æ²¡æœ‰åˆ†ç»„

**åŸå› **ï¼šå¯èƒ½æ˜¯ CSS æ ·å¼é—®é¢˜æˆ– JavaScript æ‰§è¡Œé”™è¯¯

**è§£å†³**ï¼š
1. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ JavaScript é”™è¯¯
2. æ£€æŸ¥ CSS æ˜¯å¦æ­£ç¡®åŠ è½½
3. æ£€æŸ¥å…ƒç´ æ˜¯å¦çœŸçš„è¢«åˆ›å»ºäº†ï¼ˆä½¿ç”¨æ­¥éª¤ 4ï¼‰

### é—®é¢˜ 3ï¼šåˆ†ç»„æ˜¾ç¤ºäº†ï¼Œä½†ä¸èƒ½æŠ˜å /å±•å¼€

**åŸå› **ï¼š`toggleRiskGroup` æˆ– `toggleNavGroup` å‡½æ•°æ²¡æœ‰æ­£ç¡®ç»‘å®š

**è§£å†³**ï¼š
åœ¨æ§åˆ¶å°è¾“å…¥ï¼š
```javascript
// æ£€æŸ¥å‡½æ•°æ˜¯å¦å­˜åœ¨
console.log('toggleRiskGroup:', typeof window.toggleRiskGroup)
console.log('toggleNavGroup:', typeof window.toggleNavGroup)

// å¦‚æœä¸å­˜åœ¨ï¼Œæ‰‹åŠ¨å®šä¹‰
if (typeof window.toggleRiskGroup === 'undefined') {
    window.toggleRiskGroup = function(groupId) {
        const container = document.getElementById(groupId)
        if (!container) return
        const parent = container.closest('.risk-level1-group, .risk-level2-group')
        if (!parent) return
        const isExpanded = parent.getAttribute('data-expanded') === 'true'
        const chevron = parent.querySelector('.risk-chevron')
        if (isExpanded) {
            container.style.display = 'none'
            parent.setAttribute('data-expanded', 'false')
            if (chevron) chevron.style.transform = 'rotate(-90deg)'
        } else {
            container.style.display = 'block'
            parent.setAttribute('data-expanded', 'true')
            if (chevron) chevron.style.transform = 'rotate(0deg)'
        }
    }
    console.log('âœ… toggleRiskGroup å·²å®šä¹‰')
}
```

---

## ğŸ“ æ”¶é›†è¯Šæ–­ä¿¡æ¯

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æµè§ˆå™¨æ§åˆ¶å°çš„å®Œæ•´è¾“å‡º**ï¼ˆåŒ…æ‹¬æ‰€æœ‰é”™è¯¯å’Œè­¦å‘Šï¼‰
2. **æ­¥éª¤ 3 çš„è¾“å‡ºç»“æœ**ï¼ˆæ•°æ®æ£€æŸ¥ï¼‰
3. **æ­¥éª¤ 4 çš„è¾“å‡ºç»“æœ**ï¼ˆå…ƒç´ æ£€æŸ¥ï¼‰
4. **æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬**
5. **æ˜¯å¦æœ‰ä»»ä½• JavaScript é”™è¯¯**

---

**æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤æ“ä½œï¼Œåº”è¯¥èƒ½æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ï¼** ğŸ”

